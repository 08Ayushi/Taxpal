/* Make the flex child (.main) the only scroller */
html, body { height: 100%; margin: 0; }

/* ======== Layout (sidebar + main) ======== */
:host{
  display:flex;
  height:100vh;       /* fallback */
  height:100dvh;      /* dynamic viewport */
  height:100svh;      /* small-viewport units */
  overflow:hidden;    /* .main will scroll */
  font-family:Arial,sans-serif;
  background:#FBFBFB;
}

/* ---------- Sidebar ---------- */
.sidebar{
  width:250px;
  background:#FBFBFB;
  color:#25295A;
  height:100%;
  padding:15px 0;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  flex-shrink:0;
  position:relative;
}
.sidebar h1{ text-align:center; margin-bottom:20px; color:#25295A; font-size:34px; }
.menu a{
  display:flex; align-items:center; gap:10px;
  color:#25295A; padding:10px 15px; text-decoration:none; font-size:16px; border-radius:8px;
  transition:background .15s ease, color .15s ease;
}
.menu a:hover{ background:#534CA4; color:#FBFBFB; }
.menu a.active{ background:#534CA4; color:#FBFBFB; }
.menu a .nav-ic{ width:18px; height:18px; flex:0 0 18px; color:currentColor; }

/* Profile card */
.profile{
  margin-top:auto; padding:12px 12px 8px 12px; border-top:1px solid #e9e9ef;
  background:#F5F6FF; border-radius:10px; margin:12px;
}
.profile-top{ display:grid; grid-template-columns:44px 1fr; gap:10px; align-items:center; }
.avatar{
  width:44px; height:44px; border-radius:50%;
  display:grid; place-items:center; font-weight:700; color:#fff; background:#5C62D6; letter-spacing:.5px;
}
.who .name{ font-weight:700; color:#2D335F; line-height:1.2; }
.who .email{ font-size:12px; color:#6C6F91; margin-top:2px; word-break:break-all; }
.profile-actions{
  display:grid; grid-template-columns:1fr 1fr; gap:8px 14px; padding:10px 2px 2px; margin-top:6px;
}
.profile-actions .action{
  display:inline-flex; align-items:center; gap:8px; text-decoration:none; font-size:14px;
  color:#404574; padding:4px 2px; border-radius:8px; transition:background .15s ease, color .15s ease;
}
.profile-actions .action:hover{ background:#ECEEFF; color:#2D335F; }
.profile-actions .action.active{ background:#ECEEFF; color:#2D335F; }
/* icon size fix */
.profile-actions .action svg, .profile-actions .action i{ width:18px; height:18px; flex:0 0 18px; }

/* ---------- Main (sole scroller) ---------- */
.main{
  flex:1;
  padding:15px;
  display:flex;
  flex-direction:column;
  gap:10px;
  overflow-y:auto;                 /* scrolls here */
  -webkit-overflow-scrolling:touch;
  background:#EBEFFF;
  margin-left:0;
  min-height:0;                    /* allow shrinking inside flex */
  padding-bottom:calc(env(safe-area-inset-bottom,0px) + 96px);
  scroll-padding-bottom:96px;
}

/* Top bar (base) */
.top-bar{
  display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:8px;
}
.top-bar h1{ font-size:34px; color:#2D3E50; }
.top-bar .btn{ margin-left:8px; }

/* Make the Transactions top bar sticky inside .main */
.top-bar--sticky{
  position:sticky;
  top:0;
  z-index:997; /* below sidebar (999) & overlay (998) so it never overlaps them */
  background:#EBEFFF;
  border-bottom:1px solid #E6E8FF;
  box-shadow:0 2px 8px rgba(0,0,0,.04);
  padding:10px 12px; /* keeps a comfy hit area while sticky */
}

/* Hamburger (mobile only) */
.hamburger{
  display:none;
  width:40px; height:40px;
  border:1px solid #E6E8FF; border-radius:8px;
  background:#5C62D6; color:#fff;
  cursor:pointer; align-items:center; justify-content:center; gap:4px;
}

/* ===== Buttons & Forms ===== */
.btn{
  display:inline-flex; align-items:center; gap:.5rem; border-radius:.5rem; padding:.6rem 1rem;
  font-weight:600; text-decoration:none; cursor:pointer;
  transition:transform .05s ease, box-shadow .15s ease, background-color .15s ease, color .15s ease, border-color .15s ease;
}
.btn svg{ width:1rem; height:1rem; }
.btn-primary{ background:#656ED3; color:#fff; border:1px solid #656ED3; }
.btn-primary:hover{ background:#534CA4; border-color:#534CA4; }
.btn-primary:active{ transform:translateY(.5px); }
.btn-primary:disabled{ opacity:.6; cursor:not-allowed; }
.btn-outline{ background:transparent; color:#656ED3; border:1px solid #656ED3; }
.btn-outline:hover{ background:#EBEFFF; color:#534CA4; border-color:#534CA4; }
.btn-outline:active{ transform:translateY(.5px); }
.btn-danger{ background:#EF4444; color:#fff; border:1px solid #EF4444; }
.btn-danger:hover{ background:#DC2626; border-color:#DC2626; }
.btn-danger:disabled{ opacity:.6; cursor:not-allowed; }

.add-form-section{ margin-bottom:2px; }
.form-card{ background:#fff; border-radius:.75rem; box-shadow:0 1px 3px rgba(0,0,0,0.06); border:1px solid #EBEFFF; padding:1.5rem; }
.form-header{ display:flex; justify-content:space-between; align-items:center; margin-bottom:1.5rem; padding-bottom:1rem; border-bottom:1px solid #EBEFFF; }
.form-title{ font-size:1.25rem; font-weight:600; color:#1A1A1A; margin:0; }
.close-button{ background:none; border:none; color:#25295A; cursor:pointer; padding:.5rem; border-radius:.375rem; transition:all .2s ease; }
.close-button:hover{ background:#EBEFFF; color:#1A1A1A; }

.transaction-form{ display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:1.5rem; }
.form-group{ display:flex; flex-direction:column; }
.form-label{ font-weight:500; color:#1A1A1A; margin-bottom:.5rem; font-size:.875rem; }
.form-input{
  padding:.75rem; border:1px solid #EBEFFF; border-radius:.5rem; font-size:1rem; background:#fff; color:#1A1A1A;
  transition:all .2s ease;
}
.form-input:focus{ outline:none; border-color:#656ED3; box-shadow:0 0 0 3px rgba(101,110,211,.15); }
.form-input.error{ border-color:#EF4444; }
.form-input.error:focus{ box-shadow:0 0 0 3px rgba(239,68,68,.15); }
.textarea{ resize:vertical; min-height:80px; }

.type-selector{ display:flex; gap:1rem; }
.type-option{ flex:1; cursor:pointer; }
.type-option input{ display:none; }
.type-content{
  display:flex; align-items:center; justify-content:center; gap:.5rem; padding:1rem;
  border:2px solid #EBEFFF; border-radius:.5rem; background:#fff; transition:all .2s ease; font-weight:500; color:#1A1A1A;
}
.type-option.selected .type-content{ border-color:#656ED3; background-color:#EBEFFF; }

.amount-input-container{ position:relative; }
.currency-symbol{ position:absolute; left:.75rem; top:50%; transform:translateY(-50%); color:#25295A; font-weight:500; }
.amount-input{ padding-left:2rem; }

.error-banner{
  grid-column:1 / -1; display:flex; align-items:center; gap:.5rem; padding:.75rem 1rem;
  background:#FEF2F2; border:1px solid #FECACA; border-radius:.5rem; color:#DC2626; font-size:.875rem;
}
.error-icon{ width:1.25rem; height:1.25rem; flex-shrink:0; }

.form-actions{ grid-column:1 / -1; display:flex; gap:1rem; justify-content:flex-end; margin-top:1rem; padding-top:1rem; border-top:1px solid #EBEFFF; }

/* ===== Transactions ===== */
.transactions-section{
  background:#fff;
  border-radius:.75rem;
  box-shadow:0 1px 3px rgba(0,0,0,0.06);
  border:1px solid #EBEFFF;
  overflow:visible;
}
.section-header{ display:flex; justify-content:space-between; align-items:center; padding:1.5rem 1.5rem 0; }
.section-title{ font-size:1.25rem; font-weight:600; color:#1A1A1A; margin:0; }
.section-actions{ display:flex; align-items:center; gap:1rem; }
.transaction-count{ color:#25295A; font-size:.875rem; }
.transactions-list{ padding:1.5rem; }
.transactions-list::after{ content:''; display:block; height:32px; } /* spacer so the last line never clips */

.loading-state,.empty-state{ display:flex; flex-direction:column; align-items:center; justify-content:center; padding:4rem 2rem; text-align:center; }
.empty-title{ font-size:1.25rem; font-weight:600; color:#1A1A1A; margin:1rem 0 .5rem; }
.empty-description{ color:#25295A; margin:0 0 1.5rem; max-width:400px; }

.transactions-grid{ display:grid; grid-template-columns:repeat(auto-fill, minmax(300px,1fr)); gap:1rem; }
.transaction-card{ background:#FBFBFB; border:1px solid #EBEFFF; border-radius:.75rem; padding:1rem; transition:all .2s ease; }
.transaction-card:hover{ box-shadow:0 4px 12px rgba(0,0,0,0.08); transform:translateY(-1px); }

.transaction-header{ display:flex; justify-content:space-between; align-items:center; margin-bottom:.75rem; }
.transaction-type{
  display:flex; align-items:center; gap:.5rem; padding:.25rem .75rem; border-radius:1rem; font-size:.75rem; font-weight:500;
  background:#EBEFFF; color:#25295A; border:1px solid #EBEFFF;
}
.transaction-actions{ display:flex; gap:.5rem; }
.action-button{
  background:none; border:none; padding:.375rem; border-radius:.375rem; cursor:pointer; transition:all .2s ease; color:#25295A;
  display:inline-flex; align-items:center; justify-content:center; line-height:0; width:2rem; height:2rem;
}
.action-button:focus-visible{ outline:2px solid #AFB3FF; outline-offset:2px; }
.delete-button{ color:#EF4444; }
.delete-button:hover{ background:#FEF2F2; }

.transaction-content{ display:flex; flex-direction:column; gap:.5rem; }
.transaction-category{ font-weight:600; color:#1A1A1A; margin:0; font-size:1rem; }
.transaction-amount{ font-size:1.25rem; font-weight:700; margin:0; }
.transaction-description{ color:#25295A; font-size:.875rem; margin:0; line-height:1.4; }
.transaction-date{ color:#8B95A5; font-size:.75rem; margin:0; }

/* Utilities */
.w-4{ width:1rem; } .h-4{ height:1rem; }
@keyframes spin{ from{ transform:rotate(0deg);} to{ transform:rotate(360deg);} }
.animate-spin{ animation:spin 1s linear infinite; }
.text-green-600{ color:#16A34A; } .text-red-600{ color:#DC2626; }
.bg-green-50{ background:#F0FDF4; } .bg-red-50{ background:#FEF2F2; }

/* ===== Mobile Drawer ===== */
.drawer-overlay{
  position:fixed; inset:0;
  background:rgba(0,0,0,.35);
  backdrop-filter:blur(1px);
  z-index:998;  /* sits above sticky bar (997) */
  display:none;
}
.drawer-overlay.open{ display:block; }
.close-mobile{
  display:none;
  position:absolute; right:10px; top:10px;
  width:30px; height:30px;
  border-radius:8px;
  border:1px solid #E6E8FF;
  background:#fff;
  color:#25295A;
  cursor:pointer; font-size:18px;
}

/* ===== Budgets Modal ===== */
.modal-shell{
  position:fixed; inset:0; z-index:1000;
  display:grid; place-items:center; padding:20px; background:transparent;
}
.modal-content{
  width:min(920px,96vw);
  max-height:90vh;
  overflow:auto;
  background:#fff;
  border-radius:16px;
  box-shadow:0 20px 25px -5px rgba(0,0,0,0.15), 0 10px 10px -5px rgba(0,0,0,0.06);
  border:1px solid #EBEFFF;
  padding:16px;
}

/* ================== Responsive ================== */
@media (max-width:1024px){
  .hamburger{ display:inline-flex; align-items:center; justify-content:center; }
  .top-bar h1{ font-size:28px; }

  .sidebar{
    position:fixed; top:0; left:0;
    height:100dvh; width:280px;
    transform:translateX(-100%);
    transition:transform .25s ease;
    z-index:999; /* above sticky bar */
    box-shadow:0 20px 50px rgba(0,0,0,.25);
  }
  .sidebar.open{ transform:translateX(0); }

  /* When drawer is open, prevent tapping the burger underneath */
  .sidebar.open + .main .top-bar--sticky .hamburger{
    opacity:0; pointer-events:none;
  }

  .transactions-grid{ grid-template-columns:1fr; }
}

@media (max-width:768px){
  .top-bar h1{ font-size:24px; }
  .form-actions{ flex-direction:column; }
}

/* Ultra-narrow width: keep space under last row (<=361px) */
@media (max-width:361px){
  .main{ padding-bottom:calc(env(safe-area-inset-bottom,0px) + 120px); }
  .transactions-list::after{ height:48px; }
}
